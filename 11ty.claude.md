# Eleventy (11ty) Documentation

## Overview

Eleventy is a simpler static site generator built in Node.js that transforms various template formats into static HTML. It's designed to be flexible, performant, and easy to use with minimal configuration.

### Key Characteristics
- **Zero-config by default**: Works out of the box with sensible defaults
- **Multiple template languages**: Supports Liquid, Nunjucks, Markdown, WebC, and more
- **Node.js based**: Leverages the npm ecosystem
- **Performance focused**: Fast builds and optimized output
- **Plugin extensible**: Rich ecosystem of official and community plugins

## Installation & Setup

### Local Installation (Recommended)
```bash
npm install @11ty/eleventy --save-dev
```

### Global Installation (Not Recommended)
```bash
npm install -g @11ty/eleventy
```

### Project Scripts
```json
{
  "scripts": {
    "start": "npx @11ty/eleventy --serve",
    "build": "npx @11ty/eleventy"
  }
}
```

## Configuration

### ESM Configuration (Modern Approach)
Eleventy supports ES modules in configuration files:

```javascript
// .eleventy.js
export default function (eleventyConfig) {
  // Configuration goes here
  return {
    dir: {
      input: "src",
      output: "_site"
    }
  };
}
```

### Package.json Module Type
For ESM support, ensure your package.json includes:
```json
{
  "type": "module"
}
```

## Core Configuration Patterns

### Directory Structure
```javascript
export default function (eleventyConfig) {
  return {
    dir: {
      input: "src",           // Source files
      output: "_site",        // Build output
      includes: "_includes",  // Templates and partials
      layouts: "_layouts",    // Layout files
      data: "_data"          // Global data files
    }
  };
}
```

### Passthrough Copy
Copy static assets without processing:

```javascript
// Copy all CSS files
eleventyConfig.addPassthroughCopy("./src/**/*.css");

// Copy with expansion (preserves directory structure)
eleventyConfig.addPassthroughCopy("./src/**/*.js", { expand: true });

// Copy specific file types
eleventyConfig.addPassthroughCopy("./src/**/*.{jpeg,gif,webp,png,mp4,ttf}");

// Copy from node_modules with custom path
eleventyConfig.addPassthroughCopy({
  "./node_modules/baseline-status/baseline-status.min.js": "js/baseline-status.min.js"
});
```

## Plugin System

### Official Plugins

#### SEO Plugin
```javascript
import pluginSEO from "eleventy-plugin-seo";

eleventyConfig.addPlugin(pluginSEO, {
  title: "Site Title",
  description: "Site description",
  url: "https://yoursite.com",
  author: "Your Name"
});
```

#### RSS Feed Plugin
```javascript
import { feedPlugin } from "@11ty/eleventy-plugin-rss";

eleventyConfig.addPlugin(feedPlugin, {
  type: "rss",
  outputPath: "/rss.xml",
  collection: {
    name: "posts",
    limit: 0 // 0 means no limit
  },
  metadata: {
    language: "en",
    title: "Site Title",
    subtitle: "Site Description",
    base: "https://yoursite.com",
    author: { name: "Your Name" }
  }
});
```

#### Custom Syntax Highlighting
Using Shiki for modern syntax highlighting:

```javascript
// eleventy/highlight.js
export default function (eleventyConfig, _options) {
  eleventyConfig.on("eleventy.before", async () => {
    const shiki = await import("shiki");
    const highlighter = await shiki.getHighlighter({
      themes: ["tokyo-night"],
      langs: ["css", "javascript", "typescript", "html"]
    });

    eleventyConfig.amendLibrary("md", (mdLib) =>
      mdLib.set({
        highlight: (code, lang) => {
          return highlighter.codeToHtml(code, {
            theme: "tokyo-night",
            lang
          });
        }
      })
    );
  });
}
```

## Shortcodes

Shortcodes are reusable template functions that can be called from any template:

### Date Formatting
```javascript
import { lightFormat } from "date-fns";

eleventyConfig.addShortcode("prettyDate", function (date, format = "yyyy-MM-dd") {
  // Fix UTC to localization issue where dates are a day off
  const dtDateOnly = new Date(
    date.valueOf() + date.getTimezoneOffset() * 60 * 1000
  );
  return lightFormat(dtDateOnly, format);
});
```

### Social Links
```javascript
eleventyConfig.addShortcode("socials", () => {
  return 'Find me on <a href="https://bsky.app/profile/example">Bluesky</a> or <a href="https://mastodon.social/@example">Mastodon</a>';
});
```

### Path Joining
```javascript
import { join } from "node:path";

eleventyConfig.addShortcode("joinPaths", function (...paths) {
  return join(...paths);
});
```

### Reading Time Calculator
```javascript
import { readFile } from "node:fs/promises";

eleventyConfig.addShortcode("readTime", async function (page) {
  const contents = await readFile(page.inputPath, { encoding: "utf8" });
  const wordsPerMinute = 225;
  const minutes = Math.ceil(contents.split(/[ ,]+/).length / wordsPerMinute);
  return `About ${minutes} minute read.`;
});
```

## Template Languages

### Nunjucks Templates
```html
<!-- src/_includes/layout.njk -->
<!DOCTYPE html>
<html>
<head>
  <title>{{ title or site.title }}</title>
</head>
<body>
  {{ content | safe }}
</body>
</html>
```

### Liquid Templates
```html
<!-- Using Liquid syntax -->
<article>
  <h1>{{ title }}</h1>
  <time>{% prettyDate date %}</time>
  <div>{{ content }}</div>
</article>
```

### Front Matter
```markdown
---
title: "Post Title"
date: 2024-01-01
tags: ["javascript", "web-dev"]
layout: "post.njk"
---

Post content goes here...
```

## Collections

Collections group related content together:

### Automatic Collections
```javascript
// All posts in src/posts/ automatically become collections.posts
// Access via collections.posts in templates
```

### Using Collections in Templates
```html
<!-- List all posts -->
{% for post in collections.posts %}
  <article>
    <h2><a href="{{ post.url }}">{{ post.data.title }}</a></h2>
    <time>{{ post.date | date: "YYYY-MM-DD" }}</time>
  </article>
{% endfor %}
```

## Data Files

### Global Data
```javascript
// src/_data/site.js
export default {
  title: "My Site",
  url: "https://mysite.com"
};
```

### Using Global Data
```html
{{ site.title }}
{{ site.url }}
```

## Build Process

### Development Server
```bash
npm run start
# Serves at http://localhost:8080 with live reload
```

### Production Build
```bash
npm run build
# Outputs to _site/ directory
```

### Build Events
```javascript
// Listen to build events
eleventyConfig.on("eleventy.before", async () => {
  console.log("Build starting...");
});

eleventyConfig.on("eleventy.after", async () => {
  console.log("Build complete!");
});
```

## Performance Optimization

### Asset Optimization
- Use passthrough copy for static assets
- Minimize template processing overhead
- Leverage caching for expensive operations

### Build Performance
- Use `.eleventyignore` to exclude unnecessary files
- Implement incremental builds for large sites
- Optimize image processing with plugins

## Project-Specific Patterns

### Web Component Integration
This project integrates custom web components built with Lit:

1. Components are built separately with Vite in `component/[name]/` directories
2. Built components are symlinked into `src/js/` for 11ty processing
3. Components are imported in `src/index.js` and auto-register as custom elements
4. Templates can use components directly: `<quick-search>`, `<play-ground>`, etc.

### Content Structure
```
src/
├── posts/YYYY/M/post-name/
│   └── index.html          # Post content
├── _includes/
│   ├── layout.njk          # Base layout
│   ├── post.njk           # Post layout
│   ├── nav.njk            # Navigation
│   └── quick-search.njk   # Search component template
├── css/
│   └── main.css           # Main stylesheet
└── js/                    # Symlinked components
    ├── play-ground.js
    ├── code-highlight.js
    └── quick-search.js
```

### Custom Highlighting Setup
- Uses Shiki with Tokyo Night theme
- Supports CSS, JavaScript, TypeScript, and HTML
- Integrates with markdown processing
- Provides consistent styling across the site

## Best Practices

### Configuration
- Use ESM modules for modern JavaScript support
- Keep configuration minimal and focused
- Leverage plugins for common functionality
- Use shortcodes for reusable template logic

### Content Management
- Use consistent front matter schemas
- Organize content in logical directory structures
- Leverage collections for content grouping
- Use global data for site-wide settings

### Performance
- Minimize template complexity
- Use appropriate caching strategies
- Optimize asset delivery
- Leverage static generation benefits

### Development Workflow
- Use development server for live reload
- Implement proper asset handling
- Test builds regularly
- Use version control for configuration changes

This documentation covers Eleventy's core concepts and this project's specific implementation patterns for effective static site development.